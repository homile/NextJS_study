# Udemy NextJs 강의 section5

> 페이지 사전 렌더링 & 데이터 패칭

## 실행 방법

```bash
npm run dev
```

링크: [http://localhost:3000](http://localhost:3000)

## 학습 내용

- Next.js를 사용하면 풀스택 개발을 할 수 있다.
  - Next.js는 서버사이드에서 페이지를 사전 렌더링 해주는 점이 가장 중요하다.
- 코드 실행에 있어서 클라이언트와 서버에서 코드르 실행할 때도 도움을 준다.
  - 페이지에 표시되어야 하는 데이터를 준비하거나 로딩하는 작업을 돕는다.
- Next.js를 이용해 데이터를 준비하고 패칭하는 방법

### 일반 React와 Next의 차이

- React
  - 개발자 서버로부터 파일을 받아서 HTTP 요청을 전송하는 방식
  - JavaScript와 React를 통한 렌더링이 끝나야 본 페이지에서 로딩한다.
  - 사용자들이 데이터가 로딩 될 때 까지 기다려야 한다.
- Next
  - 위의 React의 단점들을 해결할 수 있다.

### getStaticProps 함수

- 모든 페이지에 추가할 수 있고 페이지에만 추가할 수 있으며 export 해줘야한다.
- 페이지가 사전 생성되어야 하는 페이지임을 Next.js에 알려주는 역할을 한다.
- 일반적인 React에서 useEffect를 사용하여 데이터를 가져오는 것과 비슷한 역할을 한다.
- CSR방식이 아닌 SSR 방식이기 때문에 사용자가 볼 수 없는 creduntail을 사용할 수 있다.

  - 파일 시스템에 접근하는 코드와 같이 브라우저에서 작동하지 않는 코드를 실행할 수 있다.

- 동적 페이지 작업시 에러가 나는 이유
  - NextJS가 모든 페이지를 기본적으로 사전 생성하는데 동적 페이지에서는 그렇지 않기 때문이다.
  - 동적 페이지를 구성할 때는 어떤 구체적인 데이터가 필요한지 모르기 때문이다.
  - 해결하기 위해선 어떤 값에 대한 페이지가 사전 생성돼야 하는지 알려주어야 한다.
    - 비동기 함수인getStaticPaths()를 사용하면된다.

### 증분 정적 생성(ISR, Incremental Static Generation)

- 페이지를 사전 생성하긴 하지만 모든 요총에 대해 주어진 페이지를 Next.js가 재생성 할 수 있도록 한다.

### getStaticPath 함수

- 어떤 동적 페이지에 대한 사전 랜더링을 할지 미리 알려주어 getStaticProps를 사용하여 사전 랜더링을 할 수 있도록 도와준다.
- fallback key
  - 사전 생성되어야 할 페이지가 많을 때 도움이된다.
  - true로 설정하면 일부 페이지만 사전 렌더링할 수 있다.
  - paths에 포함되지 않은 페이지라도 페이지 방문 시 로딩되는 값이 유효할 수 있도록한다.
  - 방문율이 높은 페이지를 사전 생성하며 방문이 적은 페이지를 사전 생성의 우선순위를 미뤄서 필요한 경우에만 사전 생성되게 할 수 있다.
  - Link를 클릭하지 않고 url을 직접 입력하면 에러가 발생한다.
    - 데이터를 사전 패칭할 동안 보여줄 화면을 만들어서 해결할 수 있다. (로딩페이지)
  - 'blocking'설정
    - 컴포넌트에서 fallback을 확인할 필요가 없게한다.
    - 방문자가 응답받는 시간은 길어지지만 수신된 응답은 종료된다.
    - 보여주고 싶지 않은 페이지에 설정하는 방법도 있다.
